<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
.highlight { background-color: rgb(255, 255, 204); }
pre { display: inline; }
div.calls { display: inline; }
span.method_definition { font-weight: bold; }
span.method_call { font-weight: bold; }
div.line a { font-size: 12px; }
</style>
</head>
<body>
<div class='line' id='1'><pre>  1: </pre><pre>module Pod</pre></div>
<div class='line' id='2'><pre>  2: </pre><pre>  class Installer</pre></div>
<div class='line' id='3'><pre>  3: </pre><pre></pre></div>
<div class='line' id='4'><pre>  4: </pre><pre>    # Analyzes the Podfile, the Lockfile, and the sandbox manifest to generate</pre></div>
<div class='line' id='5'><pre>  5: </pre><pre>    # the information relative to a CocoaPods installation.</pre></div>
<div class='line' id='6'><pre>  6: </pre><pre>    #</pre></div>
<div class='line' id='7'><pre>  7: </pre><pre>    class Analyzer</pre></div>
<div class='line' id='8'><pre>  8: </pre><pre></pre></div>
<div class='line' id='9'><pre>  9: </pre><pre>      include Config::Mixin</pre></div>
<div class='line' id='10'><pre> 10: </pre><pre></pre></div>
<div class='line' id='11'><pre> 11: </pre><pre>      autoload :SandboxAnalyzer, 'cocoapods/installer/analyzer/sandbox_analyzer'</pre></div>
<div class='line' id='12'><pre> 12: </pre><pre></pre></div>
<div class='line' id='13'><pre> 13: </pre><pre>      # @return [Sandbox] The sandbox where the Pods should be installed.</pre></div>
<div class='line' id='14'><pre> 14: </pre><pre>      #</pre></div>
<div class='line' id='15'><pre> 15: </pre><pre>      attr_reader :sandbox</pre></div>
<div class='line' id='16'><pre> 16: </pre><pre></pre></div>
<div class='line' id='17'><pre> 17: </pre><pre>      # @return [Podfile] The Podfile specification that contains the</pre></div>
<div class='line' id='18'><pre> 18: </pre><pre>      #         information of the Pods that should be installed.</pre></div>
<div class='line' id='19'><pre> 19: </pre><pre>      #</pre></div>
<div class='line' id='20'><pre> 20: </pre><pre>      attr_reader :podfile</pre></div>
<div class='line' id='21'><pre> 21: </pre><pre></pre></div>
<div class='line' id='22'><pre> 22: </pre><pre>      # @return [Lockfile] The Lockfile that stores the information about the</pre></div>
<div class='line' id='23'><pre> 23: </pre><pre>      #         Pods previously installed on any machine.</pre></div>
<div class='line' id='24'><pre> 24: </pre><pre>      #</pre></div>
<div class='line' id='25'><pre> 25: </pre><pre>      attr_reader :lockfile</pre></div>
<div class='line' id='26'><pre> 26: </pre><pre></pre></div>
<div class='line' id='27'><pre> 27: </pre><pre>      # @param  [Sandbox]  sandbox     @see sandbox</pre></div>
<div class='line' id='28'><pre> 28: </pre><pre>      # @param  [Podfile]  podfile     @see podfile</pre></div>
<div class='line' id='29'><pre> 29: </pre><pre>      # @param  [Lockfile] lockfile    @see lockfile</pre></div>
<div class='line' id='30'><pre> 30: </pre><pre>      #</pre></div>
<div class='line' id='31'><pre> 31: </pre><div class='calls'><span class='method_definition'><pre>      def initialize(sandbox, podfile, lockfile = nil)</pre></span> <span style='display:none;'><a href='../installer.rb.html#169'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer.rb:169</a></span></div></div>
<div class='line' id='32'><pre> 32: </pre><pre>        @sandbox  = sandbox</pre></div>
<div class='line' id='33'><pre> 33: </pre><pre>        @podfile  = podfile</pre></div>
<div class='line' id='34'><pre> 34: </pre><pre>        @lockfile = lockfile</pre></div>
<div class='line' id='35'><pre> 35: </pre><pre></pre></div>
<div class='line' id='36'><pre> 36: </pre><pre>        @update_mode = false</pre></div>
<div class='line' id='37'><pre> 37: </pre><pre>        @allow_pre_downloads = true</pre></div>
<div class='line' id='38'><pre> 38: </pre><pre>      end</pre></div>
<div class='line' id='39'><pre> 39: </pre><pre></pre></div>
<div class='line' id='40'><pre> 40: </pre><pre>      # Performs the analysis.</pre></div>
<div class='line' id='41'><pre> 41: </pre><pre>      #</pre></div>
<div class='line' id='42'><pre> 42: </pre><pre>      # The Podfile and the Lockfile provide the information necessary to</pre></div>
<div class='line' id='43'><pre> 43: </pre><pre>      # compute which specification should be installed. The manifest of the</pre></div>
<div class='line' id='44'><pre> 44: </pre><pre>      # sandbox returns which specifications are installed.</pre></div>
<div class='line' id='45'><pre> 45: </pre><pre>      #</pre></div>
<div class='line' id='46'><pre> 46: </pre><pre>      # @return [AnalysisResult]</pre></div>
<div class='line' id='47'><pre> 47: </pre><pre>      #</pre></div>
<div class='line' id='48'><pre> 48: </pre><div class='calls'><span class='method_definition'><pre>      def analyze(allow_fetches = true)</pre></span> <span style='display:none;'><a href='../installer.rb.html#171'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer.rb:171</a></span></div></div>
<div class='line' id='49'><pre> 49: </pre><div class='calls'><span class='method_call'><pre>        update_repositories_if_needed if allow_fetches</pre></span> <span style='display:none;'><a href='analyzer.rb.html#152'>Pod::Installer::Analyzer#update_repositories_if_needed</a></span></div></div>
<div class='line' id='50'><pre> 50: </pre><pre>        @result = AnalysisResult.new</pre></div>
<div class='line' id='51'><pre> 51: </pre><div class='calls'><span class='method_call'><pre>        @result.podfile_state = generate_podfile_state</pre></span> <span style='display:none;'><a href='analyzer.rb.html#129'>Pod::Installer::Analyzer#generate_podfile_state</a></span></div></div>
<div class='line' id='52'><pre> 52: </pre><div class='calls'><span class='method_call'><pre>        @locked_dependencies  = generate_version_locking_dependencies</pre></span> <span style='display:none;'><a href='analyzer.rb.html#208'>Pod::Installer::Analyzer#generate_version_locking_dependencies</a></span></div></div>
<div class='line' id='53'><pre> 53: </pre><pre></pre></div>
<div class='line' id='54'><pre> 54: </pre><div class='calls'><span class='method_call'><pre>        compute_target_platforms</pre></span> <span style='display:none;'><a href='analyzer.rb.html#448'>Pod::Installer::Analyzer#compute_target_platforms</a></span></div></div>
<div class='line' id='55'><pre> 55: </pre><div class='calls'><span class='method_call'><pre>        fetch_external_sources if allow_fetches</pre></span> <span style='display:none;'><a href='analyzer.rb.html#237'>Pod::Installer::Analyzer#fetch_external_sources</a></span></div></div>
<div class='line' id='56'><pre> 56: </pre><div class='calls'><span class='method_call'><pre>        @result.specs_by_target = resolve_dependencies</pre></span> <span style='display:none;'><a href='analyzer.rb.html#280'>Pod::Installer::Analyzer#resolve_dependencies</a></span></div></div>
<div class='line' id='57'><pre> 57: </pre><div class='calls'><span class='method_call'><pre>        @result.specifications  = generate_specifications</pre></span> <span style='display:none;'><a href='analyzer.rb.html#293'>Pod::Installer::Analyzer#generate_specifications</a></span></div></div>
<div class='line' id='58'><pre> 58: </pre><div class='calls'><span class='method_call'><pre>        @result.targets         = generate_targets</pre></span> <span style='display:none;'><a href='analyzer.rb.html#164'>Pod::Installer::Analyzer#generate_targets</a></span></div></div>
<div class='line' id='59'><pre> 59: </pre><div class='calls'><span class='method_call'><pre>        @result.sandbox_state   = generate_sandbox_state</pre></span> <span style='display:none;'><a href='analyzer.rb.html#303'>Pod::Installer::Analyzer#generate_sandbox_state</a></span></div></div>
<div class='line' id='60'><pre> 60: </pre><pre>        @result</pre></div>
<div class='line' id='61'><pre> 61: </pre><pre>      end</pre></div>
<div class='line' id='62'><pre> 62: </pre><pre></pre></div>
<div class='line' id='63'><pre> 63: </pre><pre>      attr_accessor :result</pre></div>
<div class='line' id='64'><pre> 64: </pre><pre></pre></div>
<div class='line' id='65'><pre> 65: </pre><pre>      # @return [Bool] Whether an installation should be performed or this</pre></div>
<div class='line' id='66'><pre> 66: </pre><pre>      #         CocoaPods project is already up to date.</pre></div>
<div class='line' id='67'><pre> 67: </pre><pre>      #</pre></div>
<div class='line' id='68'><pre> 68: </pre><pre>      def needs_install?</pre></div>
<div class='line' id='69'><pre> 69: </pre><pre>        analysis_result = analyze(false)</pre></div>
<div class='line' id='70'><pre> 70: </pre><pre>        podfile_needs_install?(analysis_result) || sandbox_needs_install?(analysis_result)</pre></div>
<div class='line' id='71'><pre> 71: </pre><pre>      end</pre></div>
<div class='line' id='72'><pre> 72: </pre><pre></pre></div>
<div class='line' id='73'><pre> 73: </pre><pre>      # @return [Bool] Whether the podfile has changes respect to the lockfile.</pre></div>
<div class='line' id='74'><pre> 74: </pre><pre>      #</pre></div>
<div class='line' id='75'><pre> 75: </pre><pre>      def podfile_needs_install?(analysis_result)</pre></div>
<div class='line' id='76'><pre> 76: </pre><pre>        state = analysis_result.podfile_state</pre></div>
<div class='line' id='77'><pre> 77: </pre><pre>        needing_install = state.added + state.changed + state.deleted</pre></div>
<div class='line' id='78'><pre> 78: </pre><pre>        !needing_install.empty?</pre></div>
<div class='line' id='79'><pre> 79: </pre><pre>      end</pre></div>
<div class='line' id='80'><pre> 80: </pre><pre></pre></div>
<div class='line' id='81'><pre> 81: </pre><pre>      # @return [Bool] Whether the sandbox is in synch with the lockfile.</pre></div>
<div class='line' id='82'><pre> 82: </pre><pre>      #</pre></div>
<div class='line' id='83'><pre> 83: </pre><pre>      def sandbox_needs_install?(analysis_result)</pre></div>
<div class='line' id='84'><pre> 84: </pre><pre>        state = analysis_result.sandbox_state</pre></div>
<div class='line' id='85'><pre> 85: </pre><pre>        needing_install = state.added + state.changed + state.deleted</pre></div>
<div class='line' id='86'><pre> 86: </pre><pre>        !needing_install.empty?</pre></div>
<div class='line' id='87'><pre> 87: </pre><pre>      end</pre></div>
<div class='line' id='88'><pre> 88: </pre><pre></pre></div>
<div class='line' id='89'><pre> 89: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='90'><pre> 90: </pre><pre></pre></div>
<div class='line' id='91'><pre> 91: </pre><pre>      # @!group Configuration</pre></div>
<div class='line' id='92'><pre> 92: </pre><pre></pre></div>
<div class='line' id='93'><pre> 93: </pre><pre>      # @return [Bool] Whether the version of the dependencies which did non</pre></div>
<div class='line' id='94'><pre> 94: </pre><pre>      #         change in the Podfile should be locked.</pre></div>
<div class='line' id='95'><pre> 95: </pre><pre>      #</pre></div>
<div class='line' id='96'><pre> 96: </pre><pre>      attr_accessor :update_mode</pre></div>
<div class='line' id='97'><pre> 97: </pre><pre>      alias_method  :update_mode?, :update_mode</pre></div>
<div class='line' id='98'><pre> 98: </pre><pre></pre></div>
<div class='line' id='99'><pre> 99: </pre><pre>      # @return [Bool] Whether the analysis allows pre-downloads and thus</pre></div>
<div class='line' id='100'><pre>100: </pre><pre>      #         modifications to the sandbox.</pre></div>
<div class='line' id='101'><pre>101: </pre><pre>      #</pre></div>
<div class='line' id='102'><pre>102: </pre><pre>      # @note   This flag should not be used in installations.</pre></div>
<div class='line' id='103'><pre>103: </pre><pre>      #</pre></div>
<div class='line' id='104'><pre>104: </pre><pre>      # @note   This is used by the `pod outdated` command to prevent</pre></div>
<div class='line' id='105'><pre>105: </pre><pre>      #         modification of the sandbox in the resolution process.</pre></div>
<div class='line' id='106'><pre>106: </pre><pre>      #</pre></div>
<div class='line' id='107'><pre>107: </pre><pre>      attr_accessor :allow_pre_downloads</pre></div>
<div class='line' id='108'><pre>108: </pre><pre>      alias_method  :allow_pre_downloads?, :allow_pre_downloads</pre></div>
<div class='line' id='109'><pre>109: </pre><pre></pre></div>
<div class='line' id='110'><pre>110: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='111'><pre>111: </pre><pre></pre></div>
<div class='line' id='112'><pre>112: </pre><pre>      private</pre></div>
<div class='line' id='113'><pre>113: </pre><pre></pre></div>
<div class='line' id='114'><pre>114: </pre><pre>      # @!group Analysis steps</pre></div>
<div class='line' id='115'><pre>115: </pre><pre></pre></div>
<div class='line' id='116'><pre>116: </pre><pre>      # Compares the {Podfile} with the {Lockfile} in order to detect which</pre></div>
<div class='line' id='117'><pre>117: </pre><pre>      # dependencies should be locked.</pre></div>
<div class='line' id='118'><pre>118: </pre><pre>      #</pre></div>
<div class='line' id='119'><pre>119: </pre><pre>      # @return [SpecsState] the states of the Podfile specs.</pre></div>
<div class='line' id='120'><pre>120: </pre><pre>      #</pre></div>
<div class='line' id='121'><pre>121: </pre><pre>      # @note   As the target definitions share the same sandbox they should have</pre></div>
<div class='line' id='122'><pre>122: </pre><pre>      #         the same version of a Pod. For this reason this method returns</pre></div>
<div class='line' id='123'><pre>123: </pre><pre>      #         the name of the Pod (root name of the dependencies) and doesn't</pre></div>
<div class='line' id='124'><pre>124: </pre><pre>      #         group them by target definition.</pre></div>
<div class='line' id='125'><pre>125: </pre><pre>      #</pre></div>
<div class='line' id='126'><pre>126: </pre><pre>      # @todo   [CocoaPods > 0.18] If there isn't a Lockfile all the Pods should</pre></div>
<div class='line' id='127'><pre>127: </pre><pre>      #         be marked as added.</pre></div>
<div class='line' id='128'><pre>128: </pre><pre>      #</pre></div>
<div class='line' id='129'><pre>129: </pre><div class='calls'><span class='method_definition'><pre>      def generate_podfile_state</pre></span> <span style='display:none;'><a href='analyzer.rb.html#51'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:51</a></span></div></div>
<div class='line' id='130'><pre>130: </pre><pre>        if lockfile</pre></div>
<div class='line' id='131'><pre>131: </pre><pre>          pods_state = nil</pre></div>
<div class='line' id='132'><pre>132: </pre><pre>          UI.section "Finding Podfile changes" do</pre></div>
<div class='line' id='133'><pre>133: </pre><pre>            pods_by_state = lockfile.detect_changes_with_podfile(podfile)</pre></div>
<div class='line' id='134'><pre>134: </pre><pre>            pods_by_state.dup.each do |state, full_names|</pre></div>
<div class='line' id='135'><pre>135: </pre><pre>              pods_by_state[state] = full_names.map { |fn| Specification.root_name(fn) }</pre></div>
<div class='line' id='136'><pre>136: </pre><pre>            end</pre></div>
<div class='line' id='137'><pre>137: </pre><pre>            pods_state = SpecsState.new(pods_by_state)</pre></div>
<div class='line' id='138'><pre>138: </pre><pre>            pods_state.print</pre></div>
<div class='line' id='139'><pre>139: </pre><pre>          end</pre></div>
<div class='line' id='140'><pre>140: </pre><pre>          pods_state</pre></div>
<div class='line' id='141'><pre>141: </pre><pre>        else</pre></div>
<div class='line' id='142'><pre>142: </pre><div class='calls'><span class='method_call'><pre>          state = SpecsState.new</pre></span> <span style='display:none;'><a href='analyzer.rb.html#519'>Pod::Installer::Analyzer::SpecsState#initialize</a></span></div></div>
<div class='line' id='143'><pre>143: </pre><div class='calls'><span class='method_call'><pre>          state.added.concat(podfile.dependencies.map(&:root_name).uniq)</pre></span> <span style='display:none;'><a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/dependency.rb.html#157'>Pod::Dependency#root_name</a> <a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/podfile.rb.html#90'>Pod::Podfile#dependencies</a></span></div></div>
<div class='line' id='144'><pre>144: </pre><pre>          state</pre></div>
<div class='line' id='145'><pre>145: </pre><pre>        end</pre></div>
<div class='line' id='146'><pre>146: </pre><pre>      end</pre></div>
<div class='line' id='147'><pre>147: </pre><pre></pre></div>
<div class='line' id='148'><pre>148: </pre><pre>      # Updates the source repositories unless the config indicates to skip it.</pre></div>
<div class='line' id='149'><pre>149: </pre><pre>      #</pre></div>
<div class='line' id='150'><pre>150: </pre><pre>      # @return [void]</pre></div>
<div class='line' id='151'><pre>151: </pre><pre>      #</pre></div>
<div class='line' id='152'><pre>152: </pre><div class='calls'><span class='method_definition'><pre>      def update_repositories_if_needed</pre></span> <span style='display:none;'><a href='analyzer.rb.html#49'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:49</a></span></div></div>
<div class='line' id='153'><pre>153: </pre><div class='calls'><span class='method_call'><pre>        unless config.skip_repo_update?</pre></span> <span style='display:none;'><a href='../config.rb.html#368'>Pod::Config::Mixin#config</a></span></div></div>
<div class='line' id='154'><pre>154: </pre><pre>          UI.section 'Updating spec repositories' do</pre></div>
<div class='line' id='155'><pre>155: </pre><pre>            SourcesManager.update</pre></div>
<div class='line' id='156'><pre>156: </pre><pre>          end</pre></div>
<div class='line' id='157'><pre>157: </pre><pre>        end</pre></div>
<div class='line' id='158'><pre>158: </pre><pre>      end</pre></div>
<div class='line' id='159'><pre>159: </pre><pre></pre></div>
<div class='line' id='160'><pre>160: </pre><pre>      # Creates the models that represent the libraries generated by CocoaPods.</pre></div>
<div class='line' id='161'><pre>161: </pre><pre>      #</pre></div>
<div class='line' id='162'><pre>162: </pre><pre>      # @return [Array<Libraries>] the generated libraries.</pre></div>
<div class='line' id='163'><pre>163: </pre><pre>      #</pre></div>
<div class='line' id='164'><pre>164: </pre><div class='calls'><span class='method_definition'><pre>      def generate_targets</pre></span> <span style='display:none;'><a href='analyzer.rb.html#58'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:58</a></span></div></div>
<div class='line' id='165'><pre>165: </pre><pre>        targets = []</pre></div>
<div class='line' id='166'><pre>166: </pre><pre>        result.specs_by_target.each do |target_definition, specs|</pre></div>
<div class='line' id='167'><pre>167: </pre><div class='calls'><span class='method_call'><pre>          target = AggregateTarget.new(target_definition, sandbox)</pre></span> <span style='display:none;'><a href='../target/aggregate_target.rb.html#11'>Pod::AggregateTarget#initialize</a></span></div></div>
<div class='line' id='168'><pre>168: </pre><pre>          targets << target</pre></div>
<div class='line' id='169'><pre>169: </pre><pre></pre></div>
<div class='line' id='170'><pre>170: </pre><div class='calls'><span class='method_call'><pre>          if config.integrate_targets?</pre></span> <span style='display:none;'><a href='../config.rb.html#368'>Pod::Config::Mixin#config</a></span></div></div>
<div class='line' id='171'><pre>171: </pre><pre>            project_path = compute_user_project_path(target_definition)</pre></div>
<div class='line' id='172'><pre>172: </pre><pre>            user_project = Xcodeproj::Project.open(project_path)</pre></div>
<div class='line' id='173'><pre>173: </pre><pre>            native_targets = compute_user_project_targets(target_definition, user_project)</pre></div>
<div class='line' id='174'><pre>174: </pre><pre></pre></div>
<div class='line' id='175'><pre>175: </pre><pre>            target.user_project_path = project_path</pre></div>
<div class='line' id='176'><pre>176: </pre><pre>            target.client_root = project_path.dirname</pre></div>
<div class='line' id='177'><pre>177: </pre><pre>            target.user_target_uuids = native_targets.map(&:uuid)</pre></div>
<div class='line' id='178'><pre>178: </pre><pre>            target.user_build_configurations = compute_user_build_configurations(target_definition, native_targets)</pre></div>
<div class='line' id='179'><pre>179: </pre><pre>          else</pre></div>
<div class='line' id='180'><pre>180: </pre><div class='calls'><span class='method_call'><pre>            target.client_root = config.installation_root</pre></span> <span style='display:none;'><a href='../config.rb.html#159'>Pod::Config#installation_root</a> <a href='../config.rb.html#368'>Pod::Config::Mixin#config</a></span></div></div>
<div class='line' id='181'><pre>181: </pre><pre>            target.user_target_uuids = []</pre></div>
<div class='line' id='182'><pre>182: </pre><pre>            target.user_build_configurations = {}</pre></div>
<div class='line' id='183'><pre>183: </pre><pre>          end</pre></div>
<div class='line' id='184'><pre>184: </pre><pre></pre></div>
<div class='line' id='185'><pre>185: </pre><pre>          grouped_specs = specs.map do |spec|</pre></div>
<div class='line' id='186'><pre>186: </pre><div class='calls'><span class='method_call'><pre>            specs.select { |s| s.root == spec.root }</pre></span> <span style='display:none;'><a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/specification.rb.html#154'>Pod::Specification#root</a> <a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/specification.rb.html#64'>Pod::Specification#==</a></span></div></div>
<div class='line' id='187'><pre>187: </pre><pre>          end.uniq</pre></div>
<div class='line' id='188'><pre>188: </pre><pre></pre></div>
<div class='line' id='189'><pre>189: </pre><pre>          grouped_specs.each do |pod_specs|</pre></div>
<div class='line' id='190'><pre>190: </pre><div class='calls'><span class='method_call'><pre>            pod_target = PodTarget.new(pod_specs, target_definition, sandbox)</pre></span> <span style='display:none;'><a href='../target/pod_target.rb.html#20'>Pod::PodTarget#initialize</a></span></div></div>
<div class='line' id='191'><pre>191: </pre><pre>            pod_target.user_build_configurations = target.user_build_configurations</pre></div>
<div class='line' id='192'><pre>192: </pre><pre>            target.pod_targets << pod_target</pre></div>
<div class='line' id='193'><pre>193: </pre><pre>          end</pre></div>
<div class='line' id='194'><pre>194: </pre><pre>        end</pre></div>
<div class='line' id='195'><pre>195: </pre><pre>        targets</pre></div>
<div class='line' id='196'><pre>196: </pre><pre>      end</pre></div>
<div class='line' id='197'><pre>197: </pre><pre></pre></div>
<div class='line' id='198'><pre>198: </pre><pre>      # Generates dependencies that require the specific version of the Pods</pre></div>
<div class='line' id='199'><pre>199: </pre><pre>      # that haven't changed in the {Lockfile}.</pre></div>
<div class='line' id='200'><pre>200: </pre><pre>      #</pre></div>
<div class='line' id='201'><pre>201: </pre><pre>      # These dependencies are passed to the {Resolver}, unless the installer</pre></div>
<div class='line' id='202'><pre>202: </pre><pre>      # is in update mode, to prevent it from upgrading the Pods that weren't</pre></div>
<div class='line' id='203'><pre>203: </pre><pre>      # changed in the {Podfile}.</pre></div>
<div class='line' id='204'><pre>204: </pre><pre>      #</pre></div>
<div class='line' id='205'><pre>205: </pre><pre>      # @return [Array<Dependency>] the dependencies generate by the lockfile</pre></div>
<div class='line' id='206'><pre>206: </pre><pre>      #         that prevent the resolver to update a Pod.</pre></div>
<div class='line' id='207'><pre>207: </pre><pre>      #</pre></div>
<div class='line' id='208'><pre>208: </pre><div class='calls'><span class='method_definition'><pre>      def generate_version_locking_dependencies</pre></span> <span style='display:none;'><a href='analyzer.rb.html#52'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:52</a></span></div></div>
<div class='line' id='209'><pre>209: </pre><pre>        if update_mode?</pre></div>
<div class='line' id='210'><pre>210: </pre><pre>          []</pre></div>
<div class='line' id='211'><pre>211: </pre><pre>        else</pre></div>
<div class='line' id='212'><pre>212: </pre><pre>          result.podfile_state.unchanged.map do |pod|</pre></div>
<div class='line' id='213'><pre>213: </pre><pre>            lockfile.dependency_to_lock_pod_named(pod)</pre></div>
<div class='line' id='214'><pre>214: </pre><pre>          end</pre></div>
<div class='line' id='215'><pre>215: </pre><pre>        end</pre></div>
<div class='line' id='216'><pre>216: </pre><pre>      end</pre></div>
<div class='line' id='217'><pre>217: </pre><pre></pre></div>
<div class='line' id='218'><pre>218: </pre><pre>      # Fetches the podspecs of external sources if modifications to the</pre></div>
<div class='line' id='219'><pre>219: </pre><pre>      # sandbox are allowed.</pre></div>
<div class='line' id='220'><pre>220: </pre><pre>      #</pre></div>
<div class='line' id='221'><pre>221: </pre><pre>      # @note   In update mode all the external sources are refreshed while in</pre></div>
<div class='line' id='222'><pre>222: </pre><pre>      #         normal mode they are refreshed only if added or changed in the</pre></div>
<div class='line' id='223'><pre>223: </pre><pre>      #         Podfile. Moreover, in normal specifications for unchanged Pods</pre></div>
<div class='line' id='224'><pre>224: </pre><pre>      #         which are missing or are generated from an local source are</pre></div>
<div class='line' id='225'><pre>225: </pre><pre>      #         fetched as well.</pre></div>
<div class='line' id='226'><pre>226: </pre><pre>      #</pre></div>
<div class='line' id='227'><pre>227: </pre><pre>      # @note   It is possible to perform this step before the resolution</pre></div>
<div class='line' id='228'><pre>228: </pre><pre>      #         process because external sources identify a single specific</pre></div>
<div class='line' id='229'><pre>229: </pre><pre>      #         version (checkout). If the other dependencies are not</pre></div>
<div class='line' id='230'><pre>230: </pre><pre>      #         compatible with the version reported by the podspec of the</pre></div>
<div class='line' id='231'><pre>231: </pre><pre>      #         external source the resolver will raise.</pre></div>
<div class='line' id='232'><pre>232: </pre><pre>      #</pre></div>
<div class='line' id='233'><pre>233: </pre><pre>      # @return [void]</pre></div>
<div class='line' id='234'><pre>234: </pre><pre>      #</pre></div>
<div class='line' id='235'><pre>235: </pre><pre>      # TODO    Specs</pre></div>
<div class='line' id='236'><pre>236: </pre><pre>      #</pre></div>
<div class='line' id='237'><pre>237: </pre><div class='calls'><span class='method_definition'><pre>      def fetch_external_sources</pre></span> <span style='display:none;'><a href='analyzer.rb.html#55'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:55</a></span></div></div>
<div class='line' id='238'><pre>238: </pre><pre>        return unless allow_pre_downloads?</pre></div>
<div class='line' id='239'><pre>239: </pre><pre>        deps_to_fetch = []</pre></div>
<div class='line' id='240'><pre>240: </pre><pre>        deps_to_fetch_if_needed = []</pre></div>
<div class='line' id='241'><pre>241: </pre><div class='calls'><span class='method_call'><pre>        deps_with_external_source = podfile.dependencies.select { |dep| dep.external_source }</pre></span> <span style='display:none;'><a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/podfile.rb.html#90'>Pod::Podfile#dependencies</a></span></div></div>
<div class='line' id='242'><pre>242: </pre><pre>        if update_mode?</pre></div>
<div class='line' id='243'><pre>243: </pre><pre>          deps_to_fetch = deps_with_external_source</pre></div>
<div class='line' id='244'><pre>244: </pre><pre>        else</pre></div>
<div class='line' id='245'><pre>245: </pre><pre>          pods_to_fetch = result.podfile_state.added + result.podfile_state.changed</pre></div>
<div class='line' id='246'><pre>246: </pre><pre>          deps_to_fetch = deps_with_external_source.select { |dep| pods_to_fetch.include?(dep.root_name) }</pre></div>
<div class='line' id='247'><pre>247: </pre><pre>          deps_to_fetch_if_needed = deps_with_external_source.select { |dep| result.podfile_state.unchanged.include?(dep.root_name) }</pre></div>
<div class='line' id='248'><pre>248: </pre><pre>          deps_to_fetch += deps_to_fetch_if_needed.select { |dep| sandbox.specification(dep.root_name).nil? || !dep.external_source[:local].nil? || !dep.external_source[:path].nil? }</pre></div>
<div class='line' id='249'><pre>249: </pre><pre>        end</pre></div>
<div class='line' id='250'><pre>250: </pre><pre></pre></div>
<div class='line' id='251'><pre>251: </pre><pre>        unless deps_to_fetch.empty?</pre></div>
<div class='line' id='252'><pre>252: </pre><pre>          UI.section "Fetching external sources" do</pre></div>
<div class='line' id='253'><pre>253: </pre><pre>            deps_to_fetch.uniq.sort.each do |dependency|</pre></div>
<div class='line' id='254'><pre>254: </pre><pre>              source = ExternalSources.from_dependency(dependency, podfile.defined_in_file)</pre></div>
<div class='line' id='255'><pre>255: </pre><pre>              source.fetch(sandbox)</pre></div>
<div class='line' id='256'><pre>256: </pre><pre>            end</pre></div>
<div class='line' id='257'><pre>257: </pre><pre>          end</pre></div>
<div class='line' id='258'><pre>258: </pre><pre>        end</pre></div>
<div class='line' id='259'><pre>259: </pre><pre>      end</pre></div>
<div class='line' id='260'><pre>260: </pre><pre></pre></div>
<div class='line' id='261'><pre>261: </pre><pre>      # Converts the Podfile in a list of specifications grouped by target.</pre></div>
<div class='line' id='262'><pre>262: </pre><pre>      #</pre></div>
<div class='line' id='263'><pre>263: </pre><pre>      # @note   As some dependencies might have external sources the resolver</pre></div>
<div class='line' id='264'><pre>264: </pre><pre>      #         is aware of the {Sandbox} and interacts with it to download the</pre></div>
<div class='line' id='265'><pre>265: </pre><pre>      #         podspecs of the external sources. This is necessary because the</pre></div>
<div class='line' id='266'><pre>266: </pre><pre>      #         resolver needs their specifications to analyze their</pre></div>
<div class='line' id='267'><pre>267: </pre><pre>      #         dependencies.</pre></div>
<div class='line' id='268'><pre>268: </pre><pre>      #</pre></div>
<div class='line' id='269'><pre>269: </pre><pre>      # @note   The specifications of the external sources which are added,</pre></div>
<div class='line' id='270'><pre>270: </pre><pre>      #         modified or removed need to deleted from the sandbox before the</pre></div>
<div class='line' id='271'><pre>271: </pre><pre>      #         resolution process. Otherwise the resolver might use an</pre></div>
<div class='line' id='272'><pre>272: </pre><pre>      #         incorrect specification instead of pre-downloading it.</pre></div>
<div class='line' id='273'><pre>273: </pre><pre>      #</pre></div>
<div class='line' id='274'><pre>274: </pre><pre>      # @note   In update mode the resolver is set to always update the specs</pre></div>
<div class='line' id='275'><pre>275: </pre><pre>      #         from external sources.</pre></div>
<div class='line' id='276'><pre>276: </pre><pre>      #</pre></div>
<div class='line' id='277'><pre>277: </pre><pre>      # @return [Hash{TargetDefinition => Array<Spec>}] the specifications</pre></div>
<div class='line' id='278'><pre>278: </pre><pre>      #         grouped by target.</pre></div>
<div class='line' id='279'><pre>279: </pre><pre>      #</pre></div>
<div class='line' id='280'><pre>280: </pre><div class='calls'><span class='method_definition'><pre>      def resolve_dependencies</pre></span> <span style='display:none;'><a href='analyzer.rb.html#56'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:56</a></span></div></div>
<div class='line' id='281'><pre>281: </pre><pre>        specs_by_target = nil</pre></div>
<div class='line' id='282'><pre>282: </pre><div class='calls'><span class='method_call'><pre>        UI.section "Resolving dependencies of #{UI.path podfile.defined_in_file}" do</pre></span> <span style='display:none;'><a href='../user_interface.rb.html#149'>#<Class:Pod::UserInterface>#path</a> <a href='../user_interface.rb.html#43'>#<Class:Pod::UserInterface>#section</a></span></div></div>
<div class='line' id='283'><pre>283: </pre><div class='calls'><span class='method_call'><pre>          resolver = Resolver.new(sandbox, podfile, locked_dependencies)</pre></span> <span style='display:none;'><a href='../resolver.rb.html#37'>Pod::Resolver#initialize</a></span></div></div>
<div class='line' id='284'><pre>284: </pre><div class='calls'><span class='method_call'><pre>          specs_by_target = resolver.resolve</pre></span> <span style='display:none;'><a href='../resolver.rb.html#55'>Pod::Resolver#resolve</a></span></div></div>
<div class='line' id='285'><pre>285: </pre><pre>        end</pre></div>
<div class='line' id='286'><pre>286: </pre><pre>        specs_by_target</pre></div>
<div class='line' id='287'><pre>287: </pre><pre>      end</pre></div>
<div class='line' id='288'><pre>288: </pre><pre></pre></div>
<div class='line' id='289'><pre>289: </pre><pre>      # Returns the list of all the resolved the resolved specifications.</pre></div>
<div class='line' id='290'><pre>290: </pre><pre>      #</pre></div>
<div class='line' id='291'><pre>291: </pre><pre>      # @return [Array<Specification>] the list of the specifications.</pre></div>
<div class='line' id='292'><pre>292: </pre><pre>      #</pre></div>
<div class='line' id='293'><pre>293: </pre><div class='calls'><span class='method_definition'><pre>      def generate_specifications</pre></span> <span style='display:none;'><a href='analyzer.rb.html#57'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:57</a></span></div></div>
<div class='line' id='294'><pre>294: </pre><pre>        result.specs_by_target.values.flatten.uniq</pre></div>
<div class='line' id='295'><pre>295: </pre><pre>      end</pre></div>
<div class='line' id='296'><pre>296: </pre><pre></pre></div>
<div class='line' id='297'><pre>297: </pre><pre>      # Computes the state of the sandbox respect to the resolved</pre></div>
<div class='line' id='298'><pre>298: </pre><pre>      # specifications.</pre></div>
<div class='line' id='299'><pre>299: </pre><pre>      #</pre></div>
<div class='line' id='300'><pre>300: </pre><pre>      # @return [SpecsState] the representation of the state of the manifest</pre></div>
<div class='line' id='301'><pre>301: </pre><pre>      #         specifications.</pre></div>
<div class='line' id='302'><pre>302: </pre><pre>      #</pre></div>
<div class='line' id='303'><pre>303: </pre><div class='calls'><span class='method_definition'><pre>      def generate_sandbox_state</pre></span> <span style='display:none;'><a href='analyzer.rb.html#59'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:59</a></span></div></div>
<div class='line' id='304'><pre>304: </pre><pre>        sandbox_state = nil</pre></div>
<div class='line' id='305'><pre>305: </pre><div class='calls'><span class='method_call'><pre>        UI.section "Comparing resolved specification to the sandbox manifest" do</pre></span> <span style='display:none;'><a href='../user_interface.rb.html#43'>#<Class:Pod::UserInterface>#section</a></span></div></div>
<div class='line' id='306'><pre>306: </pre><div class='calls'><span class='method_call'><pre>          sandbox_analyzer = SandboxAnalyzer.new(sandbox, result.specifications, update_mode, lockfile)</pre></span> <span style='display:none;'><a href='analyzer/sandbox_analyzer.rb.html#59'>Pod::Installer::Analyzer::SandboxAnalyzer#initialize</a></span></div></div>
<div class='line' id='307'><pre>307: </pre><div class='calls'><span class='method_call'><pre>          sandbox_state = sandbox_analyzer.analyze</pre></span> <span style='display:none;'><a href='analyzer/sandbox_analyzer.rb.html#71'>Pod::Installer::Analyzer::SandboxAnalyzer#analyze</a></span></div></div>
<div class='line' id='308'><pre>308: </pre><div class='calls'><span class='method_call'><pre>          sandbox_state.print</pre></span> <span style='display:none;'><a href='analyzer.rb.html#553'>Pod::Installer::Analyzer::SpecsState#print</a></span></div></div>
<div class='line' id='309'><pre>309: </pre><pre>        end</pre></div>
<div class='line' id='310'><pre>310: </pre><pre>        sandbox_state</pre></div>
<div class='line' id='311'><pre>311: </pre><pre>      end</pre></div>
<div class='line' id='312'><pre>312: </pre><pre></pre></div>
<div class='line' id='313'><pre>313: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='314'><pre>314: </pre><pre></pre></div>
<div class='line' id='315'><pre>315: </pre><pre>      # @!group Analysis internal products</pre></div>
<div class='line' id='316'><pre>316: </pre><pre></pre></div>
<div class='line' id='317'><pre>317: </pre><pre>      # @return [Array<Dependency>] the dependencies generate by the lockfile</pre></div>
<div class='line' id='318'><pre>318: </pre><pre>      #         that prevent the resolver to update a Pod.</pre></div>
<div class='line' id='319'><pre>319: </pre><pre>      #</pre></div>
<div class='line' id='320'><pre>320: </pre><pre>      attr_reader :locked_dependencies</pre></div>
<div class='line' id='321'><pre>321: </pre><pre></pre></div>
<div class='line' id='322'><pre>322: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='323'><pre>323: </pre><pre></pre></div>
<div class='line' id='324'><pre>324: </pre><pre>      private</pre></div>
<div class='line' id='325'><pre>325: </pre><pre></pre></div>
<div class='line' id='326'><pre>326: </pre><pre>      # @!group Analysis sub-steps</pre></div>
<div class='line' id='327'><pre>327: </pre><pre></pre></div>
<div class='line' id='328'><pre>328: </pre><pre>      # Returns the path of the user project that the {TargetDefinition}</pre></div>
<div class='line' id='329'><pre>329: </pre><pre>      # should integrate.</pre></div>
<div class='line' id='330'><pre>330: </pre><pre>      #</pre></div>
<div class='line' id='331'><pre>331: </pre><pre>      # @raise  If the project is implicit and there are multiple projects.</pre></div>
<div class='line' id='332'><pre>332: </pre><pre>      #</pre></div>
<div class='line' id='333'><pre>333: </pre><pre>      # @raise  If the path doesn't exits.</pre></div>
<div class='line' id='334'><pre>334: </pre><pre>      #</pre></div>
<div class='line' id='335'><pre>335: </pre><pre>      # @return [Pathname] the path of the user project.</pre></div>
<div class='line' id='336'><pre>336: </pre><pre>      #</pre></div>
<div class='line' id='337'><pre>337: </pre><pre>      def compute_user_project_path(target_definition)</pre></div>
<div class='line' id='338'><pre>338: </pre><pre>        if target_definition.user_project_path</pre></div>
<div class='line' id='339'><pre>339: </pre><pre>          path = config.installation_root + target_definition.user_project_path</pre></div>
<div class='line' id='340'><pre>340: </pre><pre>          path = "#{path}.xcodeproj" unless File.extname(path) == '.xcodeproj'</pre></div>
<div class='line' id='341'><pre>341: </pre><pre>          path = Pathname.new(path)</pre></div>
<div class='line' id='342'><pre>342: </pre><pre>          unless path.exist?</pre></div>
<div class='line' id='343'><pre>343: </pre><pre>            raise Informative, "Unable to find the Xcode project " \</pre></div>
<div class='line' id='344'><pre>344: </pre><pre>              "`#{path}` for the target `#{target_definition.label}`."</pre></div>
<div class='line' id='345'><pre>345: </pre><pre>          end</pre></div>
<div class='line' id='346'><pre>346: </pre><pre></pre></div>
<div class='line' id='347'><pre>347: </pre><pre>        else</pre></div>
<div class='line' id='348'><pre>348: </pre><pre>          xcodeprojs = Pathname.glob(config.installation_root + '*.xcodeproj')</pre></div>
<div class='line' id='349'><pre>349: </pre><pre>          if xcodeprojs.size == 1</pre></div>
<div class='line' id='350'><pre>350: </pre><pre>            path = xcodeprojs.first</pre></div>
<div class='line' id='351'><pre>351: </pre><pre>          else</pre></div>
<div class='line' id='352'><pre>352: </pre><pre>            raise Informative, "Could not automatically select an Xcode project. " \</pre></div>
<div class='line' id='353'><pre>353: </pre><pre>              "Specify one in your Podfile like so:\n\n" \</pre></div>
<div class='line' id='354'><pre>354: </pre><pre>              "    xcodeproj 'path/to/Project.xcodeproj'\n"</pre></div>
<div class='line' id='355'><pre>355: </pre><pre>          end</pre></div>
<div class='line' id='356'><pre>356: </pre><pre>        end</pre></div>
<div class='line' id='357'><pre>357: </pre><pre>        path</pre></div>
<div class='line' id='358'><pre>358: </pre><pre>      end</pre></div>
<div class='line' id='359'><pre>359: </pre><pre></pre></div>
<div class='line' id='360'><pre>360: </pre><pre>      # Returns a list of the targets from the project of {TargetDefinition}</pre></div>
<div class='line' id='361'><pre>361: </pre><pre>      # that needs to be integrated.</pre></div>
<div class='line' id='362'><pre>362: </pre><pre>      #</pre></div>
<div class='line' id='363'><pre>363: </pre><pre>      # @note   The method first looks if there is a target specified with</pre></div>
<div class='line' id='364'><pre>364: </pre><pre>      #         the `link_with` option of the {TargetDefinition}. Otherwise</pre></div>
<div class='line' id='365'><pre>365: </pre><pre>      #         it looks for the target that has the same name of the target</pre></div>
<div class='line' id='366'><pre>366: </pre><pre>      #         definition.  Finally if no target was found the first</pre></div>
<div class='line' id='367'><pre>367: </pre><pre>      #         encountered target is returned (it is assumed to be the one</pre></div>
<div class='line' id='368'><pre>368: </pre><pre>      #         to integrate in simple projects).</pre></div>
<div class='line' id='369'><pre>369: </pre><pre>      #</pre></div>
<div class='line' id='370'><pre>370: </pre><pre>      # @note   This will only return targets that do **not** already have</pre></div>
<div class='line' id='371'><pre>371: </pre><pre>      #         the Pods library in their frameworks build phase.</pre></div>
<div class='line' id='372'><pre>372: </pre><pre>      #</pre></div>
<div class='line' id='373'><pre>373: </pre><pre>      #</pre></div>
<div class='line' id='374'><pre>374: </pre><pre>      def compute_user_project_targets(target_definition, user_project)</pre></div>
<div class='line' id='375'><pre>375: </pre><pre>        if link_with = target_definition.link_with</pre></div>
<div class='line' id='376'><pre>376: </pre><pre>          targets = native_targets(user_project).select { |t| link_with.include?(t.name) }</pre></div>
<div class='line' id='377'><pre>377: </pre><pre>          raise Informative, "Unable to find the targets named `#{link_with.to_sentence}` to link with target definition `#{target_definition.name}`" if targets.empty?</pre></div>
<div class='line' id='378'><pre>378: </pre><pre>        elsif target_definition.link_with_first_target?</pre></div>
<div class='line' id='379'><pre>379: </pre><pre>          targets = [ native_targets(user_project).first ].compact</pre></div>
<div class='line' id='380'><pre>380: </pre><pre>          raise Informative, "Unable to find a target" if targets.empty?</pre></div>
<div class='line' id='381'><pre>381: </pre><pre>        else</pre></div>
<div class='line' id='382'><pre>382: </pre><pre>          target = native_targets(user_project).find { |t| t.name == target_definition.name.to_s }</pre></div>
<div class='line' id='383'><pre>383: </pre><pre>          targets = [ target ].compact</pre></div>
<div class='line' id='384'><pre>384: </pre><pre>          raise Informative, "Unable to find a target named `#{target_definition.name.to_s}`" if targets.empty?</pre></div>
<div class='line' id='385'><pre>385: </pre><pre>        end</pre></div>
<div class='line' id='386'><pre>386: </pre><pre>        targets</pre></div>
<div class='line' id='387'><pre>387: </pre><pre>      end</pre></div>
<div class='line' id='388'><pre>388: </pre><pre></pre></div>
<div class='line' id='389'><pre>389: </pre><pre>      # @return [Array<PBXNativeTarget>] Returns the user’s targets, excluding</pre></div>
<div class='line' id='390'><pre>390: </pre><pre>      #         aggregate targets.</pre></div>
<div class='line' id='391'><pre>391: </pre><pre>      #</pre></div>
<div class='line' id='392'><pre>392: </pre><pre>      def native_targets(user_project)</pre></div>
<div class='line' id='393'><pre>393: </pre><pre>        user_project.targets.reject do |target|</pre></div>
<div class='line' id='394'><pre>394: </pre><pre>          target.is_a? Xcodeproj::Project::Object::PBXAggregateTarget</pre></div>
<div class='line' id='395'><pre>395: </pre><pre>        end</pre></div>
<div class='line' id='396'><pre>396: </pre><pre>      end</pre></div>
<div class='line' id='397'><pre>397: </pre><pre></pre></div>
<div class='line' id='398'><pre>398: </pre><pre>      # @return [Hash{String=>Symbol}] A hash representing the user build</pre></div>
<div class='line' id='399'><pre>399: </pre><pre>      #         configurations where each key corresponds to the name of a</pre></div>
<div class='line' id='400'><pre>400: </pre><pre>      #         configuration and its value to its type (`:debug` or `:release`).</pre></div>
<div class='line' id='401'><pre>401: </pre><pre>      #</pre></div>
<div class='line' id='402'><pre>402: </pre><pre>      def compute_user_build_configurations(target_definition, user_targets)</pre></div>
<div class='line' id='403'><pre>403: </pre><pre>        if user_targets</pre></div>
<div class='line' id='404'><pre>404: </pre><pre>          user_targets.map { |t| t.build_configurations.map(&:name) }.flatten.inject({}) do |hash, name|</pre></div>
<div class='line' id='405'><pre>405: </pre><pre>            unless name == 'Debug' || name == 'Release'</pre></div>
<div class='line' id='406'><pre>406: </pre><pre>              hash[name] = :release</pre></div>
<div class='line' id='407'><pre>407: </pre><pre>            end</pre></div>
<div class='line' id='408'><pre>408: </pre><pre>            hash</pre></div>
<div class='line' id='409'><pre>409: </pre><pre>          end.merge(target_definition.build_configurations || {})</pre></div>
<div class='line' id='410'><pre>410: </pre><pre>        else</pre></div>
<div class='line' id='411'><pre>411: </pre><pre>          target_definition.build_configurations || {}</pre></div>
<div class='line' id='412'><pre>412: </pre><pre>        end</pre></div>
<div class='line' id='413'><pre>413: </pre><pre>      end</pre></div>
<div class='line' id='414'><pre>414: </pre><pre></pre></div>
<div class='line' id='415'><pre>415: </pre><pre>      # @return [Platform] The platform for the library.</pre></div>
<div class='line' id='416'><pre>416: </pre><pre>      #</pre></div>
<div class='line' id='417'><pre>417: </pre><pre>      # @note   This resolves to the lowest deployment target across the user</pre></div>
<div class='line' id='418'><pre>418: </pre><pre>      #         targets.</pre></div>
<div class='line' id='419'><pre>419: </pre><pre>      #</pre></div>
<div class='line' id='420'><pre>420: </pre><pre>      # @todo   Is assigning the platform to the target definition the best way</pre></div>
<div class='line' id='421'><pre>421: </pre><pre>      #         to go?</pre></div>
<div class='line' id='422'><pre>422: </pre><pre>      #</pre></div>
<div class='line' id='423'><pre>423: </pre><pre>      def compute_platform_for_target_definition(target_definition, user_targets)</pre></div>
<div class='line' id='424'><pre>424: </pre><pre>        return target_definition.platform if target_definition.platform</pre></div>
<div class='line' id='425'><pre>425: </pre><pre>        name = nil</pre></div>
<div class='line' id='426'><pre>426: </pre><pre>        deployment_target = nil</pre></div>
<div class='line' id='427'><pre>427: </pre><pre></pre></div>
<div class='line' id='428'><pre>428: </pre><pre>        user_targets.each do |target|</pre></div>
<div class='line' id='429'><pre>429: </pre><pre>          name ||= target.platform_name</pre></div>
<div class='line' id='430'><pre>430: </pre><pre>          raise Informative, "Targets with different platforms" unless name == target.platform_name</pre></div>
<div class='line' id='431'><pre>431: </pre><pre>          if !deployment_target || deployment_target > Version.new(target.deployment_target)</pre></div>
<div class='line' id='432'><pre>432: </pre><pre>            deployment_target = Version.new(target.deployment_target)</pre></div>
<div class='line' id='433'><pre>433: </pre><pre>          end</pre></div>
<div class='line' id='434'><pre>434: </pre><pre>        end</pre></div>
<div class='line' id='435'><pre>435: </pre><pre></pre></div>
<div class='line' id='436'><pre>436: </pre><pre>        target_definition.set_platform(name, deployment_target)</pre></div>
<div class='line' id='437'><pre>437: </pre><pre>        Platform.new(name, deployment_target)</pre></div>
<div class='line' id='438'><pre>438: </pre><pre>      end</pre></div>
<div class='line' id='439'><pre>439: </pre><pre></pre></div>
<div class='line' id='440'><pre>440: </pre><pre>      # Precompute the platforms for each target_definition in the Podfile</pre></div>
<div class='line' id='441'><pre>441: </pre><pre>      #</pre></div>
<div class='line' id='442'><pre>442: </pre><pre>      # @note The platforms are computed and added to each target_definition</pre></div>
<div class='line' id='443'><pre>443: </pre><pre>      #       because it might be necessary to infer the platform from the</pre></div>
<div class='line' id='444'><pre>444: </pre><pre>      #       user targets.</pre></div>
<div class='line' id='445'><pre>445: </pre><pre>      #</pre></div>
<div class='line' id='446'><pre>446: </pre><pre>      # @return [void]</pre></div>
<div class='line' id='447'><pre>447: </pre><pre>      #</pre></div>
<div class='line' id='448'><pre>448: </pre><div class='calls'><span class='method_definition'><pre>      def compute_target_platforms</pre></span> <span style='display:none;'><a href='analyzer.rb.html#54'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:54</a></span></div></div>
<div class='line' id='449'><pre>449: </pre><div class='calls'><span class='method_call'><pre>        podfile.target_definition_list.each do |target_definition|</pre></span> <span style='display:none;'><a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/podfile.rb.html#79'>Pod::Podfile#target_definition_list</a></span></div></div>
<div class='line' id='450'><pre>450: </pre><div class='calls'><span class='method_call'><pre>          if config.integrate_targets?</pre></span> <span style='display:none;'><a href='../config.rb.html#368'>Pod::Config::Mixin#config</a></span></div></div>
<div class='line' id='451'><pre>451: </pre><pre>            project_path = compute_user_project_path(target_definition)</pre></div>
<div class='line' id='452'><pre>452: </pre><pre>            user_project = Xcodeproj::Project.open(project_path)</pre></div>
<div class='line' id='453'><pre>453: </pre><pre>            targets = compute_user_project_targets(target_definition, user_project)</pre></div>
<div class='line' id='454'><pre>454: </pre><pre>            platform = compute_platform_for_target_definition(target_definition, targets)</pre></div>
<div class='line' id='455'><pre>455: </pre><pre>          else</pre></div>
<div class='line' id='456'><pre>456: </pre><div class='calls'><span class='method_call'><pre>            unless target_definition.platform</pre></span> <span style='display:none;'><a href='../../../../../../.rbenv/versions/2.0.0-p247/lib/ruby/gems/2.0.0/bundler/gems/Core-9e592ef49853/lib/cocoapods-core/podfile/target_definition.rb.html#312'>Pod::Podfile::TargetDefinition#platform</a></span></div></div>
<div class='line' id='457'><pre>457: </pre><pre>              raise Informative, "It is necessary to specify the platform in the Podfile if not integrating."</pre></div>
<div class='line' id='458'><pre>458: </pre><pre>            end</pre></div>
<div class='line' id='459'><pre>459: </pre><pre>          end</pre></div>
<div class='line' id='460'><pre>460: </pre><pre>        end</pre></div>
<div class='line' id='461'><pre>461: </pre><pre>      end</pre></div>
<div class='line' id='462'><pre>462: </pre><pre></pre></div>
<div class='line' id='463'><pre>463: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='464'><pre>464: </pre><pre></pre></div>
<div class='line' id='465'><pre>465: </pre><pre>      class AnalysisResult</pre></div>
<div class='line' id='466'><pre>466: </pre><pre></pre></div>
<div class='line' id='467'><pre>467: </pre><pre>        # @return [SpecsState] the states of the Podfile specs.</pre></div>
<div class='line' id='468'><pre>468: </pre><pre>        #</pre></div>
<div class='line' id='469'><pre>469: </pre><pre>        attr_accessor :podfile_state</pre></div>
<div class='line' id='470'><pre>470: </pre><pre></pre></div>
<div class='line' id='471'><pre>471: </pre><pre>        # @return [Hash{TargetDefinition => Array<Spec>}] the specifications</pre></div>
<div class='line' id='472'><pre>472: </pre><pre>        #         grouped by target.</pre></div>
<div class='line' id='473'><pre>473: </pre><pre>        #</pre></div>
<div class='line' id='474'><pre>474: </pre><pre>        attr_accessor :specs_by_target</pre></div>
<div class='line' id='475'><pre>475: </pre><pre></pre></div>
<div class='line' id='476'><pre>476: </pre><pre>        # @return [Array<Specification>] the specifications of the resolved</pre></div>
<div class='line' id='477'><pre>477: </pre><pre>        #         version of Pods that should be installed.</pre></div>
<div class='line' id='478'><pre>478: </pre><pre>        #</pre></div>
<div class='line' id='479'><pre>479: </pre><pre>        attr_accessor :specifications</pre></div>
<div class='line' id='480'><pre>480: </pre><pre></pre></div>
<div class='line' id='481'><pre>481: </pre><pre>        # @return [SpecsState] the states of the {Sandbox} respect the resolved</pre></div>
<div class='line' id='482'><pre>482: </pre><pre>        #         specifications.</pre></div>
<div class='line' id='483'><pre>483: </pre><pre>        #</pre></div>
<div class='line' id='484'><pre>484: </pre><pre>        attr_accessor :sandbox_state</pre></div>
<div class='line' id='485'><pre>485: </pre><pre></pre></div>
<div class='line' id='486'><pre>486: </pre><pre>        # @return [Array<Target>] The Podfile targets containing library</pre></div>
<div class='line' id='487'><pre>487: </pre><pre>        #         dependencies.</pre></div>
<div class='line' id='488'><pre>488: </pre><pre>        #</pre></div>
<div class='line' id='489'><pre>489: </pre><pre>        attr_accessor :targets</pre></div>
<div class='line' id='490'><pre>490: </pre><pre></pre></div>
<div class='line' id='491'><pre>491: </pre><pre>        # @return [Hash{String=>Symbol}] A hash representing all the user build</pre></div>
<div class='line' id='492'><pre>492: </pre><pre>        #         configurations across all integration targets. Each key</pre></div>
<div class='line' id='493'><pre>493: </pre><pre>        #         corresponds to the name of a configuration and its value to</pre></div>
<div class='line' id='494'><pre>494: </pre><pre>        #         its type (`:debug` or `:release`).</pre></div>
<div class='line' id='495'><pre>495: </pre><pre>        #</pre></div>
<div class='line' id='496'><pre>496: </pre><pre>        def all_user_build_configurations</pre></div>
<div class='line' id='497'><pre>497: </pre><pre>          targets.inject({}) do |result, target|</pre></div>
<div class='line' id='498'><pre>498: </pre><pre>            result.merge(target.user_build_configurations)</pre></div>
<div class='line' id='499'><pre>499: </pre><pre>          end</pre></div>
<div class='line' id='500'><pre>500: </pre><pre>        end</pre></div>
<div class='line' id='501'><pre>501: </pre><pre>      end</pre></div>
<div class='line' id='502'><pre>502: </pre><pre></pre></div>
<div class='line' id='503'><pre>503: </pre><pre>      #-----------------------------------------------------------------------#</pre></div>
<div class='line' id='504'><pre>504: </pre><pre></pre></div>
<div class='line' id='505'><pre>505: </pre><pre>      # This class represents the state of a collection of Pods.</pre></div>
<div class='line' id='506'><pre>506: </pre><pre>      #</pre></div>
<div class='line' id='507'><pre>507: </pre><pre>      # @note The names of the pods stored by this class are always the **root**</pre></div>
<div class='line' id='508'><pre>508: </pre><pre>      #       name of the specification.</pre></div>
<div class='line' id='509'><pre>509: </pre><pre>      #</pre></div>
<div class='line' id='510'><pre>510: </pre><pre>      # @note The motivation for this class is to ensure that the names of the</pre></div>
<div class='line' id='511'><pre>511: </pre><pre>      #       subspecs are added instead of the name of the Pods.</pre></div>
<div class='line' id='512'><pre>512: </pre><pre>      #</pre></div>
<div class='line' id='513'><pre>513: </pre><pre>      class SpecsState</pre></div>
<div class='line' id='514'><pre>514: </pre><pre></pre></div>
<div class='line' id='515'><pre>515: </pre><pre>        # @param  [Hash{Symbol=>String}] pods_by_state</pre></div>
<div class='line' id='516'><pre>516: </pre><pre>        #         The **root** name of the pods grouped by their state</pre></div>
<div class='line' id='517'><pre>517: </pre><pre>        #         (`:added`, `:removed`, `:changed` or `:unchanged`).</pre></div>
<div class='line' id='518'><pre>518: </pre><pre>        #</pre></div>
<div class='line' id='519'><pre>519: </pre><div class='calls'><span class='method_definition'><pre>        def initialize(pods_by_state = nil)</pre></span> <span style='display:none;'><a href='analyzer.rb.html#142'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:142</a> <a href='analyzer/sandbox_analyzer.rb.html#72'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer/sandbox_analyzer.rb:72</a></span></div></div>
<div class='line' id='520'><pre>520: </pre><pre>          @added     = []</pre></div>
<div class='line' id='521'><pre>521: </pre><pre>          @deleted   = []</pre></div>
<div class='line' id='522'><pre>522: </pre><pre>          @changed   = []</pre></div>
<div class='line' id='523'><pre>523: </pre><pre>          @unchanged = []</pre></div>
<div class='line' id='524'><pre>524: </pre><pre></pre></div>
<div class='line' id='525'><pre>525: </pre><pre>          if pods_by_state</pre></div>
<div class='line' id='526'><pre>526: </pre><pre>            @added     = pods_by_state[:added]     || []</pre></div>
<div class='line' id='527'><pre>527: </pre><pre>            @deleted   = pods_by_state[:removed]   || []</pre></div>
<div class='line' id='528'><pre>528: </pre><pre>            @changed   = pods_by_state[:changed]   || []</pre></div>
<div class='line' id='529'><pre>529: </pre><pre>            @unchanged = pods_by_state[:unchanged] || []</pre></div>
<div class='line' id='530'><pre>530: </pre><pre>          end</pre></div>
<div class='line' id='531'><pre>531: </pre><pre>        end</pre></div>
<div class='line' id='532'><pre>532: </pre><pre></pre></div>
<div class='line' id='533'><pre>533: </pre><pre>        # @return [Array<String>] the names of the pods that were added.</pre></div>
<div class='line' id='534'><pre>534: </pre><pre>        #</pre></div>
<div class='line' id='535'><pre>535: </pre><pre>        attr_accessor :added</pre></div>
<div class='line' id='536'><pre>536: </pre><pre></pre></div>
<div class='line' id='537'><pre>537: </pre><pre>        # @return [Array<String>] the names of the pods that were changed.</pre></div>
<div class='line' id='538'><pre>538: </pre><pre>        #</pre></div>
<div class='line' id='539'><pre>539: </pre><pre>        attr_accessor :changed</pre></div>
<div class='line' id='540'><pre>540: </pre><pre></pre></div>
<div class='line' id='541'><pre>541: </pre><pre>        # @return [Array<String>] the names of the pods that were deleted.</pre></div>
<div class='line' id='542'><pre>542: </pre><pre>        #</pre></div>
<div class='line' id='543'><pre>543: </pre><pre>        attr_accessor :deleted</pre></div>
<div class='line' id='544'><pre>544: </pre><pre></pre></div>
<div class='line' id='545'><pre>545: </pre><pre>        # @return [Array<String>] the names of the pods that were unchanged.</pre></div>
<div class='line' id='546'><pre>546: </pre><pre>        #</pre></div>
<div class='line' id='547'><pre>547: </pre><pre>        attr_accessor :unchanged</pre></div>
<div class='line' id='548'><pre>548: </pre><pre></pre></div>
<div class='line' id='549'><pre>549: </pre><pre>        # Displays the state of each pod.</pre></div>
<div class='line' id='550'><pre>550: </pre><pre>        #</pre></div>
<div class='line' id='551'><pre>551: </pre><pre>        # @return [void]</pre></div>
<div class='line' id='552'><pre>552: </pre><pre>        #</pre></div>
<div class='line' id='553'><pre>553: </pre><div class='calls'><span class='method_definition'><pre>        def print</pre></span> <span style='display:none;'><a href='analyzer.rb.html#308'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:308</a></span></div></div>
<div class='line' id='554'><pre>554: </pre><div class='calls'><span class='method_definition'><pre>          added    .sort.each { |pod| UI.message("A".green  + " #{pod}", '', 2) }</pre></span> <span style='display:none;'><a href='analyzer.rb.html#554'>/Users/eloy/Code/CocoaPods/CocoaPods/lib/cocoapods/installer/analyzer.rb:554</a></span></div></div>
<div class='line' id='555'><pre>555: </pre><pre>          deleted  .sort.each { |pod| UI.message("R".red    + " #{pod}", '', 2) }</pre></div>
<div class='line' id='556'><pre>556: </pre><pre>          changed  .sort.each { |pod| UI.message("M".yellow + " #{pod}", '', 2) }</pre></div>
<div class='line' id='557'><pre>557: </pre><pre>          unchanged.sort.each { |pod| UI.message("-"        + " #{pod}", '', 2) }</pre></div>
<div class='line' id='558'><pre>558: </pre><pre>        end</pre></div>
<div class='line' id='559'><pre>559: </pre><pre></pre></div>
<div class='line' id='560'><pre>560: </pre><pre>        # Adds the name of a Pod to the give state.</pre></div>
<div class='line' id='561'><pre>561: </pre><pre>        #</pre></div>
<div class='line' id='562'><pre>562: </pre><pre>        # @param  [String]</pre></div>
<div class='line' id='563'><pre>563: </pre><pre>        #         the name of the Pod.</pre></div>
<div class='line' id='564'><pre>564: </pre><pre>        #</pre></div>
<div class='line' id='565'><pre>565: </pre><pre>        # @param  [Symbol]</pre></div>
<div class='line' id='566'><pre>566: </pre><pre>        #         the state of the Pod.</pre></div>
<div class='line' id='567'><pre>567: </pre><pre>        #</pre></div>
<div class='line' id='568'><pre>568: </pre><pre>        # @raise  If there is an attempt to add the name of a subspec.</pre></div>
<div class='line' id='569'><pre>569: </pre><pre>        #</pre></div>
<div class='line' id='570'><pre>570: </pre><pre>        # @return [void]</pre></div>
<div class='line' id='571'><pre>571: </pre><pre>        #</pre></div>
<div class='line' id='572'><pre>572: </pre><pre>        def add_name(name, state)</pre></div>
<div class='line' id='573'><pre>573: </pre><pre>          raise "[Bug] Attempt to add subspec to the pods state" if name.include?('/')</pre></div>
<div class='line' id='574'><pre>574: </pre><pre>          self.send(state) << name</pre></div>
<div class='line' id='575'><pre>575: </pre><pre>        end</pre></div>
<div class='line' id='576'><pre>576: </pre><pre></pre></div>
<div class='line' id='577'><pre>577: </pre><pre>      end</pre></div>
<div class='line' id='578'><pre>578: </pre><pre>    end</pre></div>
<div class='line' id='579'><pre>579: </pre><pre>  end</pre></div>
<div class='line' id='580'><pre>580: </pre><pre>end</pre></div>
<script src='../../../../../../../../zepto.js'></script>
<script>
  var update_highlight = function() {
    $('div.highlight').removeClass('highlight');
    var hash = window.location.hash;
    if (hash.length > 0) $(hash).addClass('highlight');
  };
  $(window).on('hashchange', update_highlight);
  update_highlight();

  $(window).on('mouseenter', 'div.calls', function() {
    $(this).children().last().show();
  });
  $(window).on('mouseleave', 'div.calls', function() {
    $(this).children().last().hide();
  });
</script>
</body>
</html>
